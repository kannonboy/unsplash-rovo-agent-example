modules:

  rovo:agent:
    - key: unsplash-rovo-agent
      name: Unsplash Rovo Agent
      description: An agent that can fetch images from Unsplash
      prompt: >
        # About you

        You are an agent that can fetch images from Unsplash. You should ONLY
        perform work relating to fetching images. Do not perform any other
        tasks.

        # Handling chat messages

        If a user asks for an image in chat you should use the "search-photos" 
        action to find a relevant image (or relevant images - you can call
        it multiple times if needed!).

        # Handling comments

        If a user @mentions you in a comment you should review the rest of 
        the comments on the work item to see if there is further context (for 
        example, the user may be responding to an earlier comment from you).
        You should then proceed as above, using the "search-photos" action.

        # Handling work items

        If you are assigned to a work item by a user, you should fetch all of 
        the work items fields and comments to review them for useful context. 
        Then you should determine whether you are able to meaningfully contribute
        to the work item by searching for images. If so, use the "search-photos"  
        action as above. If not, you should respond to the user asking for 
        clarification or to reassign the work item.

        # General tips

        Unless the user specifically asks for a single image, you should return 
        multiple options for them to choose from.
      conversationStarters:
        - Find me a photo relating to nature
        - Find a selection of photos relating to technology
      actions:
        - search-photos

  action:
    # This action searches Unsplash for photos based on a query and optional filters.
    # It uses an Access key (set by an administrator) for authentication.
    - key: search-photos
      name: Search Unsplash for photos
      function: searchPhotos
      actionVerb: GET
      description: >
        When a user asks to log a message, this action logs the message to the
        Forge logs.
      inputs:
        query:
          title: query
          type: string
          required: true
          description: |
            Search terms. For example, 'nature', 'technology', 'people'.
        color:
          title: color
          type: string
          required: false
          description: |
            Filter results by color. Valid values are: black_and_white, black, white, yellow, orange, red, purple, magenta, green, teal, blue.
        orientation:
          title: orientation
          type: string
          required: false
          description: |
            Filter by photo orientation. Valid values are: landscape, portrait, squarish.

  jira:adminPage:
    - key: unsplash-admin
      title: Unsplash Configuration
      render: native
      resource: admin
      resolver:
        function: resolver

  function:
    - key: searchPhotos
      handler: actions.searchPhotos
    - key: resolver
      handler: resolver.handler

resources:
  - key: admin
    path: src/frontend/admin.jsx

app:
  runtime:
    name: nodejs22.x
    memoryMB: 256
    architecture: arm64
  id: ari:cloud:ecosystem::app/b4e83644-a5d8-42fb-a2eb-714459fe8178

permissions:
  scopes:
    - storage:app
  external:
    fetch:
      backend:
        - address: api.unsplash.com
